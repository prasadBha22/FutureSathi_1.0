
@{
    ViewBag.Title = "Index";
    Layout ="~/Views/Shared/ChildLayout.cshtml";
}

<h2 class="text-center p-3 fw-bolder" style="color: #FF666D;">Subscription</h2>

<script>

    $(document).ready(function () {

        LoadUser();
        substationTYpe();
        $("#txt_Search").keyup(function () {
            $.ajax({
                "url": "/Admin/Search?txt_Search="+$(this).val(),
                "method": "GET",
                success: function (resp) {
                    //console.log(resp);
                    $("#TblUser").empty();

                        $.each(resp, function (Index, item) {

                            $("#TblUser").append("<tr><td>" + item.id + "</td><td>" + item.First_Name + "</td><td>" + item.Last_Name + "</td><td>" + item.Email + "</td><td>" + item.substationTYpe  + "</td></tr >");
                        })


                },
                error: function (resp) {
                    console.log(resp);
                }
            })

        });

        $("#btnSubmit").click(function () {
            var email = $("#Email").val();
            var id = $("#substationTYpe").val();
            $.ajax
                ({
                    "url": "/Admin/Update?email="+email+"&id="+id+"",
                    "method": "GET",
                    success: function (data) {
                        /*  *//*console.log(data)*/
                        if (data.Code==0) {
                            alert(data.Message);
                        }
                        location.reload(true);


                    },
                    error: function () {

                    }

        })
        });
    });
    function LoadUser() {
        $.ajax
            ({
                "url": "/Admin/GetAllUser",
                "method": "GET",
                success: function (resp) {
                    //console.log(resp);
                    if (resp.Code == 0) {
                        $("#TblUser").empty();

                        $.each(resp.Message, function (Index, item) {

                            $("#TblUser").append("<tr><td>" + item.id + "</td><td>" + item.First_Name + "</td><td>" + item.Last_Name + "</td><td>" + item.Email + "</td><td>" + item.substationTYpe + "</td></tr >");
                        })
                    }
                },
                error: function (resp) {
                    console.log(resp);
                }
            })
    }
    function substationTYpe() {
        $.ajax
            ({
                "url": "/Admin/getsubstationTYpe",
                "method": "GET",
                success: function (resp) {
                    //console.log(resp);
                    if (resp.Code == 0) {
                        $("#substationTYpe").empty();

                        $.each(resp.Message, function (Index, item) {

                            $("#substationTYpe").append("<option value=" + item.Value + ">" + item.Text+"</option>");
                        })
                    }
                },
                error: function (resp) {
                    console.log(resp);
                }
            })
    }
</script>

<div class="container-fluid">

    <div class=" row p-3">

        <div class="col-8">
            <div class="row pb-4">
                <div class="col-4">

                </div>
                <div class="col-4">

                </div>
                <div class="col-4">
                    <input type="text" class="form-control-lg" id="txt_Search" placeholder="Search" name="txt_Search">
                </div>


            </div>
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>Id</th>
                        <th>First_Name</th>
                        <th>Last_Name</th>
                        <th>Email</th>
                        <th>substation Type</th>
                    </tr>
                </thead>
                <tbody id="TblUser">
                </tbody>
            </table>
        </div>
        <div class="col-4 pt-5" style=" background-color: rgb(255, 229, 217);">
            <div class="p-2">
                <label for="email" class="form-label">Email:</label>
                <input type="email" class="form-control " id="Email" placeholder=" 👤 Enter email" name="email">
            </div>
            <div class="p-2">
                <label for="substationTYpe" class="form-label">substationType:</label>
                <select class="form-control " id="substationTYpe">
                </select>
            </div>
            <div class="p-2">
                <input type="datetime-local" class="form-control " id="Sub_Date">
            </div>
            <div class="p-2">
                <button class="btn btn-outline-danger fw-bold w-100" id="btnSubmit">Submit</button>
            </div>
        </div>

    </div>


</div>

